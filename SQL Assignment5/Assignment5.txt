ASSIGNMENT 5

JOINS

Q1.LIST ENAME, JOB, ANNUAL SAL, DEPTNO, DNAME WHO EARN 30000 PER YEAR AND WHO ARE NOT CLERKS.
                    SELECT ENAME , DESIGNATION , SALARY*12 ANNUAL_SALARY,E.DEPTNO, DNAME FROM EMPLOYE E,DEPT D WHERE E.DEPTNO=D.DEPTNO  AND SALARY*12=30000 AND DESIGNATION!=’CLERK’;

Q2. LIST OUT THE ALL EMPLOYEES BY NAME AND EMPLOYEE NUMBER ALONG WITH THEIR MANAGER'S NAME AND EMPLOYEE NUMBER.
                    SELECT E1.ENAME,E1.EID,E2.ENAME,E2.EID FROM EMPLOYE E1,EMPLOYE E2 WHERE E1.MGR =E2.EID;

Q3.DISPLAY ENAME,DNAME EVEN IF THERE NO EMPLOYEES WORKING IN A PARTICULAR DEPARTMENT.
                    SELECT ENAME,DNAME  FROM EMPLOYE E RIGHT OUTER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE ENAME IS NULL;

Q4.DISPLAY THE DEPARTMENT NAME ALONG WITH TOTAL SALARY IN EACH DEPARTMENT
                   SELECT DNAME,SUM(SALARY) FROM EMPLOYE E INNER JOIN DEPT D  ON E.DEPTNO=D.DEPTNO GROUP BY DNAME;

Q5.DISPLAY EMPLOYEE NAME AND DEPARTMENT NAME FOR EACH EMPLOYEE
                  SELECT ENAME,DNAME FROM EMPLOYE E,DEPT D WHERE E.DEPTNO=D.DEPTNO;

Q6.DISPLAY LOCATION NAME OF THE EMPLOYEE WHO EARN COMMISSION.
                 SELECT LOCATION FROM EMPLOYE E INNER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE COMMISSION IS NOT NULL;

Q7.DISPLAY DEPT NAME OF THE EMPLOYEE WHO EARN MIN SALARY AND HAVE NO REPORTING MANAGER
                 SELECT DNAME FROM EMPLOYE E INNER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE SALARY=(SELECT MIN(SALARY) FROM EMPLOYE) AND MGR IS NULL;

Q8.DISPLAY DEPT NAME,LOC OF ALL THE EMPLOYEES WHO ARE REPORTING TO SMITH.
                SELECT DNAME, LOCATION  FROM EMPLOYE E1 , EMPLOYE E2 , DEPT D WHERE E1.ENAME = ‘SMITH' AND E1.EID=E2.MGR    AND E2.DEPTNO=D.DEPTNO;

Q9.LIST ALL THE DEPT NAME AND LOCATION OF ALL THE SALESMAN MANAGER'S MANAGER.
              SELECT DNAME,LOCATION  FROM EMPLOYE E1 , EMPLOYE E2 , EMPLOYE E3 , DEPT D  WHERE E1.JOB=‘SALESMAN’ AND E1.MGR=E2.EID AND E2.MGR = E3.EID  AND E3.DEPTNO=D.DEPTNO;

Q10.LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPT AND THEY ARE MANAGER.
               SELECT ENAME FROM EMPLOYE E,DEPT D  WHERE E.DEPTNO=D.DEPTNO AND DNAME=’RESEARCH’ AND DESIGNATION='MANAGER';

Q11.DISPLAY THE NUMBER OF EMPLOYEES WHO ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER.
              SELECT COUNT(E3.EID)  FROM EMPLOYE E1,EMPLOYE E2,EMPLOYE E3 WHERE E1.ENAME=‘BLAKE’ AND E1.MGR = E2.EID
 AND E3.SALARY < E2.SALARY ;

Q12.LIST THE EMPLOYEE DEPTNAME AND LOCATION OF ALL THE EMPLOYEES WHO ARE ANALYST,REPORTING TO BLAKE.
               SELECT DNAME,LOCATION FROM EMPLOYE E1 , EMPLOYE E2 , DEPT D WHERE E1.ENAME= ‘BLAKE’  AND E1.EID=E2.MGR AND E2.DESIGNATION=‘ANALYST’  AND E2.DEPTNO=D.DEPTNO;

Q13.DISPLAY THE EMPLOYEE NAMES,HIREDATE,COMM OF FORD'S MANAGER
                SELECT ENAME,HIREDATE,COMMISSION FROM EMPLOYE E1,EMPLOYE E2 WHERE E1.MGR=E2.EID AND E1.ENAME=’FORD’;

Q14.DISPLAY ENAME, DNAME OF ALL THE EMPLOYEES WHOSE SALARY LESS THAN AVG SAL OF DEPT 30
               SELECT ENAME,DNAME FROM EMPLOYE E,DEPT D  WHERE E.DEPTNO=D.DEPTNO AND SALARY<(SELECT AVG(SALARY) FROM EMPLOYE WHERE  DEPTNO=30);

Q15.DISPLAY ENAME DNAME AND LOC OF ALL THE EMPLOYEES WHO ARE  WORKING FOR JONES
              SELECT E2.ENAME,DNAME,LOCATION  FROM EMPLOYE E1 ,DEPT D,EMPLOYE E2 WHERE E2.DEPTNO=D.DEPTNO AND E1.EID=E2.MGR  AND  E1.ENAME=’JONES’;

Q16.DISPLAY ENAME DNAME OF ALL THE EMPLOYEES WHOSE NAME STARTS WITH S
               SELECT ENAME,DNAME  FROM EMPLOYE E,DEPT D  WHERE E.DEPTNO=D.DEPTNO AND E.ENAME LIKE 'S%';

Q17.LIST THE DNAME WHO ARE NOT HAVING ANY EMPLOYEE IN IT
               SELECT DNAME  FROM EMPLOYE E RIGHT OUTER JOIN DEPT D ON E.DEPTNO=D.DEPTNO  WHERE ENAME IS NULL;


Q18.DISPLAY EMPLOYEE WHO ARE GETTING SAME COMMISSION
              SELECT E1. ENAME,E2.ENAME,E1.COMMISSION,E2.COMMISSION  FROM EMPLOYE E1,EMPLOYE E2  WHERE E1.COMMMISSION=E2.COMMISSION   AND  E1.EID<>E2.EID;

Q19.DISPLAY ALL THE DEPT NAMES IRRESPECTIVE OF ANY EMPLOYEE WORKING IN IT OR NOT. IF AN EMPLOYEE IS WORKING DISPLAY HIS NAME.
            SELECT DNAME  FROM EMPLOYE E FULL OUTER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE ENAME IS NULL;

Q20.WRITE A QUERY TO DISPLAY EMPLOYEE NAME, JOB, DNAME, LOCATION OF ALL EMPLOYEES WHO ARE WORKING AS ACTUAL MANAGERS AND WORKS  AT CHICAGO.
            SELECT ENAME,DESIGNATION,DNAME,LOCATION FROM EMPLOYE E ,DEPT D WHERE E.DEPTNO=D.DEPTNO AND DESIGNATION=’MANAGER’ AND LOCATION=’CHICAGO’;

Q21.LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800.
            SELECT DNAME FROM EMPLOYE E,DEPT D  WHERE E.DEPTNO=D.DEPTNO  AND HIREDATE BETWEEN ’01-JAN-81’ AND ’31-DEC-82’
 AND SALARY>1800;

Q22.DISPLAY 2ND LEAST SALARY FROM EMPLOYEE TABLE.
           SELECT MIN(E1.SALARY)  FROM EMPLOYE E1 , EMPLOYE E2   WHERE E1.SALARY > E2.SALARY ;

Q23.LIST THE EMPLOYEES WHOSE ANNUAL SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY.
           SELECT ENAME FROM EMPLOYE WHERE SALARY*12>1500 AND HIREDATE <’01-JAN-82’;

Q24.DISPLAY DNAME, LOC, DEPTNO OF EMPLOYEES WHO HAS SAME REPORTING MANAGER
            SELECT DISTINCT DNAME,LOCATION,D.DEPTNO  FROM EMPLOYE E1 ,DEPT D,EMPLOYE E2  WHERE E1.DEPTNO=D.DEPTNO
 AND E1.MGR=E2.MGR AND E1.EID!=E2.EID;

Q25.DISPLAY EMPLOYEE NAME ALONG WITH THEIR MANAGER NAME.
           SELECT E1.ENAME,E2.ENAME FROM EMPLOYE E1,EMPLOYE E2  WHERE E1.MGR=E2.EID;

Q26.DISPLAY EMPLOYEE NAME AND HIS DEPT NAME FOR THE EMPLOYEES WHOSE NAME STARTS WITH ‘S’.
            SELECT E1.ENAME,D.DNAME  FROM EMPLOYE E1,DEPT D  WHERE E1.DEPTNO=D.DEPTNO  AND E1.ENAME LIKE 'S%';

Q27.DISPLAY EMPLOYEES WHO ARE GETTING SAME SALARY.
             SELECT E1.ENAME  FROM EMPLOYE E1,EMPLOYE E2 WHERE E1.SALARY=E2.SALARY  AND E1.EID!=E2.EID;