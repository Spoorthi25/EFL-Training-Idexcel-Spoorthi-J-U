ASSIGNMENT 3 

GROUP BY AND HAVING CLAUSE

Q1. WRITE A QUERY TO DISPLAY TOTAL SALARY NEEDED TO PAY EACH JOB IN EMPLOYEE TABLE.
             SELECT SUM(SALARY),DESIGNATION FROM EMPLOYE  GROUP BY DESIGNATION;

Q2.WRITE A QUERY TO DISPLAY THE HIRE DATE ON WHICH AT LEAST 3 EMPLOYEES WHERE HIRED.
            SELECT HIREDATE FROM EMPLOYE GROUP BY HIREDATE HAVING COUNT(*)>=3;

Q3.WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHICH HAS MORE THAN 2 EMPLOYEES AND THE TOTAL AMOUNT REQUIRED TO PAY THE MONTHLY SALARIES OF ALL THE EMPLOYEES IN THAT DEPARTMENT SHOULD BE MORE THAN 9000.
            SELECT DEPTNO,SUM(SALARY) FROM EMPLOYE WHERE SALARY>9000 GROUP BY DEPTNO HAVING COUNT(*)>2;

Q4.WRITE A QUERY TO DISPLAY NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT AND ITS’ AVERAGE SALARY BY EXCLUDING ALL THE EMPLOYEES WHOSE SALARY IS LESS THAN THEIR COMMISSION.
            SELECT COUNT(*),AVG(SALARY) FROM EMPLOYE WHERE SALARY<COMMISSION  GROUP BY DEPTNO;

Q5.WRITE A QUERY TO DISPLAY THE SALARIES WHICH HAS REPETITIONS IN THE SAL COLUMN OF EMPLOYEE TABLE.
            SELECT COUNT(*),SALARY  FROM EMPLOYE GROUP BY SALARY HAVING COUNT(*)>=1;

Q6.WRITE A QUERY TO DISPLAY THE EMPLOYEE NAME ONLY IF MORE THAN ONE PERSON IN THE EMPLOYEES OF THE COMPANY HAS SAME NAME.
            SELECT ENAME,COUNT(*) FROM EMPLOYE GROUP BY ENAME HAVING COUNT(*)>1;

Q7.WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHOSE AVERAGE SALARY IS BETWEEN 2500 AND 3000.
            SELECT DEPTNO,AVG(SALARY) FROM EMPLOYE WHERE SALARY BETWEEN 2500 AND 3000 GROUP BY DEPTNO;

Q8.WRITE A QUERY TO DISPLAY THE NUMBER OF EMPLOYEES ONLY IF THEY ARE WORKING AS MANAGER OR ANALYST AND THEIR ANNUAL SAL SHOULD END WITH A ZERO, IN EACH DEPARTMENT.
             SELECT COUNT(*),DEPTNO FROM EMPLOYE WHERE DESIGNATION IN('MANAGER','ANALYST') AND SALARY*12 LIKE  '%0' GROUP BY DEPTNO;

Q9.WRITE A QUERY TO DISPLAY NO OF CLERKS WORKING IN EACH DEPARTMENT.
            SELECT COUNT(DESIGNATION),DEPTNO FROM EMPLOYE WHERE DESIGNATION='CLERK' GROUP BY DEPTNO;

Q10.WRITE A QUERY TO DISPLAY HIGHEST SALARY GIVEN TO A MANAGER IN EACH DEPARTMENT.
            SELECT MAX(SALARY),DEPTNO FROM EMPLOYE WHERE DESIGNATION='MANAGER' GROUP BY DEPTNO;

Q11.WRITE A QUERY TO DISPLAY NO OF TIMES THE SALARIES HAVE REPEATED IN THE EMP TABLE.
             SELECT COUNT(SALARY),SALARY FROM EMPLOYE GROUP BY SALARY HAVING COUNT(*)>1;

Q12.WRITE A QUERY TO DISPLAY DEPTNO AND NUNBER OF EMPLOYEES WORKING IN EACH DEPARTMENT EXCEPT FOR THOSE WORKING IN DEPT 10
             SELECT DEPTNO,COUNT(*) FROM EMPLOYE WHERE DEPTNO<>10 GROUP BY DEPTNO;

Q13.WAQTD NUMBER OF EMPLOYEES GETTING COMISSION IN EACH DEPARTMENT
             SELECT COUNT(*),DEPTNO FROM EMPLOYE WHERE COMISSION IS NOT NULL GROUP BY DEPTNO;

Q14.WAQTD NUMBER OF EMPLOYEES GETTING SALARY MORE THAN 1600 EXCLUDING ALL THE MANAGERS IN EACH DEPARTEMNT
            SELECT COUNT(*),DEPTNO  FROM EMPLOYE WHERE SALARY>1600 AND DESIGNATION<>'MANAGER' GROUP BY DEPTNO;

Q15.WAQTD AVERAGE SALARY NEEDED TO PAY ALL THE EMPLOYEES WHO ARE HAVING A REPORTING MANAGER IN EACH JOB.
            SELECT AVG(SALARY),DESIGNATION FROM EMPLOYE WHERE MGR IS NOT NULL GROUP BY DESIGNATION;

Q16.WAQTD NUMBER OF EMPLOYEES HIRED INTO THE SAME DEPARTMENT ON THE SAME DAY
            SELECT COUNT(*),HIREDATE FROM EMPLOYE GROUP BY HIREDATE HAVING COUNT(*)>1;

Q17.WAQTD NUMBER OF EMPLOYEES GETTING THE SAME SALARY, WORKING IN THE SAME DEPARTMENT
            SELECT COUNT(*),DEPTNO,SALARY FROM EMPLOYE GROUP BY DEPTNO,SALARY HAVING COUNT(SALARY)>1;

Q18.WAQTD MAXIMUM SALARY GIVEN IN EACH DESIGNATION EXCLUDING THOSE WHOS NAME STARTS WITH ‘K’
            SELECT MAX(SALARY),DESIGNATION FROM EMPLOYE WHERE ENAME NOT LIKE 'K%' GROUP BY DESIGNATION;

Q19.WAQTD NUMBER OF EMPLOYEES REPORTING TO 7839
            SELECT COUNT(*) FROM EMPLOYE  WHERE MGR=7839;

Q20.WAQTD NUMBER OF EMPLOYEE NAMES STARTING WITH AN VOWEL IN EACH DEPARTMENT
            SELECT ENAME FROM EMPLOYE WHERE ENAME LIKE 'A%' OR ENAME LIKE 'E%' OR ENAME LIKE 'I%' OR ENAME LIKE 'O%' OR ENAME LIKE 'U%';